# MusicPilot - 任务清单

> **📌 详细任务追踪请参考进化系统**: `evolution/tasks.json`
>
> 本文件提供快速概览，任务状态以进化系统为准。**任务执行时必须同步更新 tasks.json**。

---

## 📊 任务统计（实时）

| Milestone | 状态 | 进度 | 已完成 | 待办 | 阻塞 | 预估工时 |
|-----------|------|------|--------|------|------|----------|
| M1: 元数据链 (v0.1.0) | ✅ 已完成 | 100% | 7 | 0 | 0 | 28h |
| M2: 播放列表 (v0.2.0) | ✅ 已完成 | 100% | 5 | 0 | 0 | 22h |
| M3: 媒体库管理 (v0.3.0) | ✅ 已完成 | 100% | 4 | 0 | 0 | 17h |
| M4: 资源站点和下载器对接 (v0.4.0) | 🔄 进行中 | 14% | 1 | 6 | 0 | 35h |
| M5: 订阅功能 (v0.5.0) | ⏸️ 待开始 | 0% | 1 | 5 | 0 | 26h |
| M6: 播放器界面 (v0.6.0) | ⏸️ 待开始 | 0% | 0 | 5 | 0 | 22h |
| M7: 发布和部署 (v1.0.0) | ⏸️ 待开始 | 0% | 0 | 1 | 0 | 8h |
| **总计** | - | **58%** | **18** | **17** | **0** | **158h** |

---

## 📌 Milestone 1: 元数据链 (v0.1.0)

**目标**: 建立可运行的开发环境，实现元数据获取和缓存
**状态**: ✅ 已完成 (100%)
**预计周期**: Week 1

### ✅ 已完成任务 (7/7)
- [x] M1-T1: ChainBase 基类 (4h)
- [x] M1-T2: MetadataChain 元数据链 (6h)
- [x] M1-T3: MusicBrainz 模块 (8h)
- [x] M1-T4: Cache 缓存模块 (6h)
- [x] M1-T5: 数据模型和操作类 (4h)
- [x] M1-T6: 元数据 API 端点 (4h)
- [x] M1-T7: 前端元数据页面 (6h)

**完成时间**: 2026-02-21

---

## 📌 Milestone 2: 播放列表 (v0.2.0)

**目标**: 实现播放列表管理和播放
**状态**: ✅ 已完成 (100%)
**预计周期**: Week 2

### ✅ 已完成任务 (5/5)
- [x] M2-T1: Playlist 模型和操作类 (3h)
- [x] M2-T2: PlaylistChain 播放列表链 (5h)
- [x] M2-T3: 播放列表 API 端点 (3h)
- [x] M2-T4: 前端播放列表界面 (5h)
- [x] M2-T5: PlaybackChain 播放链 (6h)

**完成时间**: 2026-02-22

---

## 📌 Milestone 3: 媒体库管理 (v0.3.0)

**目标**: 实现媒体库扫描和管理
**状态**: ✅ 已完成 (100%)
**预计周期**: Week 3

### ✅ 已完成任务 (4/4)
- [x] M3-T1: Library 模型和操作类 (3h)
- [x] M3-T2: TransferChain 转移链 (6h)
- [x] M3-T3: 媒体库 API 端点 (3h)
- [x] M3-T4: 前端媒体库界面 (5h)

**完成时间**: 2026-02-22

---

## 📌 Milestone 4: 资源站点和下载器对接 (v0.4.0)

**目标**: 实现资源站点搜索、下载器对接和下载进度监控
**状态**: 🔄 进行中 (14%)
**预计周期**: Week 4-5

### ✅ 已完成任务 (1/7)
- [x] M4-T1: 资源站点数据模型 (3h)
  - Site 和 SubscribeRelease 数据库模型
  - SiteOper 和 SubscribeReleaseOper 操作类
  - 站点管理和订阅发布记录 API 端点
  - **完成时间**: 2026-02-26

### 🔄 进行中任务 (0/7)
- [ ] M4-T2: TorrentsChain 资源链 (8h)
  - 资源搜索链
  - 并发搜索多个站点
  - 结果排序和过滤
  - 缓存机制

### ⏸️ 待办任务 (5/7)
- [ ] M4-T3: 站点模块 (10h)
  - SiteModule 基类
  - 登录和认证
  - search_torrent()
  - RSS 解析
  - 搜索结果标准化
- [ ] M4-T4: DownloaderChain 下载器链 (6h)
  - 下载器对接链
  - 推送种子到下载器
  - 监控下载进度
  - 控制下载任务
- [ ] M4-T5: 下载器对接模块 (6h)
  - qBittorrent 模块
  - Transmission 模块
  - 推送种子和获取进度
- [ ] M4-T6: 前端站点管理界面 (6h)
  - 站点列表和详情
  - 站点添加/编辑/删除
  - 测试站点连接
- [ ] M4-T7: 下载进度监控任务 (2h)
  - 定时任务配置
  - 进度监控逻辑
  - 更新数据库状态

---

## 📌 Milestone 5: 订阅功能 (v0.5.0)

**目标**: 实现艺术家、专辑、歌单、榜单订阅
**状态**: ⏸️ 待开始 (0%)
**预计周期**: Week 6-7

### ✅ 已完成任务 (1/6)
- [x] M5-T2: SubscribeRelease 模型 (2h)
  - 订阅发布记录模型
  - 记录订阅发布和下载状态
  - **完成时间**: 2026-02-26 (M4-T1)

### ⏸️ 待办任务 (5/6)
- [ ] M5-T1: 订阅数据模型（扩展）(2h)
  - 扩展 Subscribe 模型
  - 添加 source_type、playlist_id、rules 字段
  - 更新相关操作类和 API
- [ ] M5-T3: SubscribeChain 订阅链（融合）(10h)
  - 支持四种订阅类型
  - 统一工作流程
  - 艺术家/专辑/歌单/榜单检查
- [ ] M5-T4: 歌单/榜单抓取模块 (6h)
  - 网易云音乐模块
  - QQ 音乐模块
  - 抓取歌单和榜单
- [ ] M5-T5: 订阅定时任务 (2h)
  - APScheduler 配置
  - 定时检查逻辑
- [ ] M5-T6: 前端订阅管理界面 (6h)
  - 四种订阅类型
  - 订阅历史和发布记录

---

## 📌 Milestone 6: 播放器界面 (v0.6.0)

**目标**: 实现播放器前端界面和功能
**状态**: ⏸️ 待开始 (0%)
**预计周期**: Week 8

### ⏸️ 待办任务 (5/5)
- [ ] M6-T1: 播放器组件 (6h)
- [ ] M6-T2: 播放器 API 集成 (4h)
- [ ] M6-T3: 播放器快捷键 (2h)
- [ ] M6-T4: 可视化效果 (6h)
- [ ] M6-T5: 歌词显示 (4h)

---

## 📌 Milestone 7: 发布和部署 (v1.0.0)

**目标**: 准备发布和部署
**状态**: ⏸️ 待开始 (0%)
**预计周期**: Week 9

### ⏸️ 待办任务 (1/1)
- [ ] M7-T1: 发布准备 (8h)

---

## 🚀 当前 Sprint 计划

### 本周 (2026-02-24 ~ 2026-03-02)
**进行中**: M4-T2 TorrentsChain 资源链

**下一步**:
- M4-T3: 站点模块

---

## 💡 开发提示

### 技术栈
- **后端**: FastAPI + SQLAlchemy + APScheduler
- **前端**: Vue 3 + Vite + Naive UI + Howler.js
- **数据库**: SQLite (开发) / PostgreSQL (生产)
- **部署**: Docker + Docker Compose

### 参考资料
- MoviePilot: https://github.com/jxxghp/MoviePilot
- MusicBrainz API: https://musicbrainz.org/doc/MusicBrainz_API
- FastAPI: https://fastapi.tiangolo.com/
- Vue 3: https://vuejs.org/

---

## 📋 任务执行规范

### 1. 开始任务前
- 检查任务依赖是否完成
- 更新 tasks.json 中的 `started_at`
- 更新任务状态为 `in_progress`

### 2. 任务进行中
- 每完成一个子任务，更新进度
- 遇到阻塞时，更新 `blocked_tasks`

### 3. 任务完成时
- 更新 tasks.json 中的：
  - `status` → `completed`
  - `completed_at` → 当前时间
  - `actual_hours` → 实际工时
- 更新里程碑的进度
- 同步更新 docs/tasks.md

### 4. Git 提交规范
```
<type>(<scope>): <subject>

<body>

<footer>
```

类型:
- `feat`: 新功能
- `fix`: Bug 修复
- `docs`: 文档更新
- `style`: 代码格式调整（不影响逻辑）
- `refactor`: 重构
- `test`: 测试相关
- `chore`: 构建/工具链相关

---

**最后更新**: 2026-02-27
**数据来源**: evolution/tasks.json